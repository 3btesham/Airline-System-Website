<!DOCTYPE html>
<html>
    <head>
        <title>Customer Dashboard</title>
        <style type="text/css">
            table, th, td {
                border: 1px solid black;
                padding-left: 2px;
                padding-right: 2px;
            }
        </style>
    </head>
    <body>
        <h1>Welcome, {{ customer['first_name'] }}</h1>
        <h2>View My flights</h2>
        <table>
            {%for flights in future_flights%}
            <tr>
                <td>{{ flight['flight_number'] }}</td>
                <td>{{ flight['depart_date'] }}</td>
                <td>{{ flight['depart_time'] }}</td>
                <td>{{ flight['depart_airport_code'] }}</td>
            </tr>
        </table> 
        <br></br>
        <h2>Search for flights</h2>
        <form action="/search_flights" method="get"> 
            <label for="source">Source City/Airport:</label>
            <input type="text" id="source" name="source" required><br><br>

            <label for="destination">Destination City/Airport:</label>
            <input type="text" id="destination" name="destination" required><br><br>

            <label for="departure-date">Departure Date:</label>
            <input type="date" id="departure-date" name="departure_date" required><br><br>

            <label for="return-date">Return Date(Optional):</label>
            <input type="date" id="return-date" name="return_date" ><br><br>

            <input type="submit" value="Search Flights">
        </form> 
        <br></br>

        <h2>Purchase a Ticket</h2>
        <form action="/purchase_ticket" method="post"> 
            <label for="source">Source City/Airport:</label>
            <input type="text" id="source" name="source" required><br><br>

            <label for="destination">Destination City/Airport:</label>
            <input type="text" id="destination" name="destination" required><br><br>

            <label for="departure-date">Departure Date:</label>
            <input type="date" id="departure-date" name="departure_date" required><br><br>

            <label for="return-date">Return Date(Optional):</label>
            <input type="date" id="return-date" name="return_date" ><br><br>

            <input type="submit" value="Purchase a Flight">
        </form> 
        <br></br>

        <h2>Cancel a Trip</h2>
        <form action="/purchase_ticket" method="get"> 
            <label for="ticket_id">CustomerId to cancel</label>
            <input type="text" id="ticket_id" name="ticket_id" required><br><br>

            <input type ="submit" value="Cancel the flight">

        <h2>Give ratings</h2>
        <form action="/purchase_ticket" method="post"> 
            <label for="rating">Rating (1 to 10):</label>
            <input type="range" id="rating" name="rating" min="1" max="10" required oninput="this.nextElementSibling.value = this.value">
            <output>5</output><br><br>
            <label for="comments"></label>
            <textarea id="comments" name="comments" rows="4" cols="50" required placeholder="Enter your comments here..."></textarea><br><br>
            <input type="submit" value="Rate the flight">
        <br></br>
        <br></br>
        <b>Track My Spending:</b>
        <!-- Total spending in the past year -->
        <p>Total amount spent in the past year: <span>{{ spendings_past_year }}</span></p>
        <!-- Spending within a specified range -->
        <form action="/spending_range" method="POST">
            <label for="start_date">Start Date:</label>
            <input type="date" id="start_date" name="start_date">
            <label for="end_date">End Date:</label>
            <input type="date" id="end_date" name="end_date">
            <input type="submit" value="View Spending">
        </form>
        
        <!-- Visualization for spending within the specified range (e.g., bar chart or table) -->
        
        <!-- JavaScript to fetch and update spending data -->
        <script>
            function fetchPastYearSpending() {
                // Fetch total spending in the past year
                fetch('/get_past_year_spending')
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById('past_year_spending').textContent = '$' + data.spendings;
                    })
                    .catch(error => console.error('Error fetching spending:', error));
            }
        
            // Call the function when the page loads
            fetchPastYearSpending();
        </script>


    </body>

</html>
